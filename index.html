<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Blok</title>
  <!-- Disable caching for local development -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <link href="https://fonts.googleapis.com/css?family=PT+Mono" rel="stylesheet">
  <style>
    .toggle-text-swap {
      font-size: 0px;
      vertical-align: bottom;
    }

    .toggle-text-swap::before {
      display: inline;
      font-size: 13px;
      content: attr(data-default-text);
    }

    .thin-mode .thin-mode-content {
      max-width: 500px;
      border-left-width: 1px;
      border-right-width: 1px;
      border-left-style: solid;
      border-right-style: solid;
      border-color: #eee;
      padding-left: 15px;
      padding-right: 15px;
    }

    /* Playground tabs */
    .playground-tab {
      position: relative;
      padding: 0 16px;
      height: 50px;
      line-height: 50px;
      font-size: 13px;
      color: #999;
      cursor: pointer;
      transition: color 0.15s;
      background: none;
      border: none;
      font-family: inherit;
    }
    .playground-tab:hover { color: #333; }
    .playground-tab[aria-selected="true"] { color: #000; font-weight: 600; }
    .playground-tab[aria-selected="true"]::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 16px;
      right: 16px;
      height: 2px;
      background: #000;
      border-radius: 1px;
    }

    /* Status bar controls */
    .statusbar-toggle {
      font-family: 'PT Mono', monospace;
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #1a1a1a;
      background: none;
      border: 1px solid #f0f0f0;
      border-radius: 4px;
      padding: 3px 10px;
      cursor: pointer;
      transition: border-color 0.12s, background 0.12s;
    }
    .statusbar-toggle:hover {
      border-color: #ddd;
      background: #f7f7f8;
    }

    /* Icon gallery */
    .icon-gallery { padding: 40px 0 100px; }
    .icon-group { margin-bottom: 40px; }
    .icon-group-title {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #999;
      margin-bottom: 16px;
      padding-bottom: 8px;
      border-bottom: 1px solid #f0f0f0;
    }
    .icon-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 2px;
    }
    .icon-cell {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      padding: 20px 12px;
      border-radius: 8px;
      transition: background 0.12s;
      cursor: default;
    }
    .icon-cell:hover { background: #f7f7f8; }
    .icon-cell .icon-preview {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #1a1a1a;
    }
    .icon-cell .icon-preview svg {
      width: 24px;
      height: 24px;
    }
    .icon-cell .icon-name {
      font-size: 10px;
      font-family: 'PT Mono', monospace;
      color: #999;
      text-align: center;
      word-break: break-all;
    }
  </style>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
</head>
<body class="font-sans text-sm leading-relaxed m-0 bg-white text-black">
  <div class="text-base">
    <div class="flex flex-wrap items-center h-[50px] leading-[50px] px-[30px] max-md:px-5 border-b border-[#e8e8eb]">
      <a class="font-bold text-inherit no-underline mr-6" href="https://github.com/JackUait/blok">Blok</a>
      <div role="tablist">
        <button class="playground-tab" role="tab" aria-selected="true" data-tab="editor">Editor</button>
        <button class="playground-tab" role="tab" aria-selected="false" data-tab="icons">Icons</button>
      </div>
    </div>

    <!-- Editor tab -->
    <div id="tab-editor" class="mt-[30px]" role="tabpanel">
      <div class="thin-mode-content max-w-content mx-auto antialiased max-md:px-5">
        <div id="blok"></div>
        <div class="flex items-center gap-6 fixed bottom-0 left-0 right-0 bg-white border-t border-[#f0f0f0] text-[11px] tracking-[0.08em] uppercase px-[30px] max-md:px-5 py-3 z-[1] select-none max-md:hidden" style="font-family: 'PT Mono', monospace; color: #999;">
          <div class="flex items-center gap-2">
            <span>Readonly</span>
            <button class="statusbar-toggle" id="toggleReadOnlyButton">
              <span id="readonly-state">Off</span>
            </button>
          </div>
          <div class="flex items-center">
            <button class="statusbar-toggle" id="enableThinModeButton">
              <span class="toggle-text-swap" data-default-text="Enable" data-toggled-text="Disable"></span>
              thin mode
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Icons tab -->
    <div id="tab-icons" class="hidden" role="tabpanel">
      <div class="max-w-4xl mx-auto px-[30px] max-md:px-5 icon-gallery" id="icon-gallery"></div>
    </div>
  </div>


  <!-- Load Tools -->
  <!--
    You can upload Tools to your project's directory and connect them by relative links.

    Also you can load each Tool from CDN or use NPM/Yarn packages.
  -->

  <!-- Initialization -->
  <script type="module">
    import { Blok } from './src/blok.ts';
    import { Paragraph, Header, List, Table, Bold, Italic, Link } from './src/tools/index.ts';
    import * as Icons from './src/components/icons/index.ts';

    window.Blok = Blok;

    /**
     * To initialize the Blok, create a new instance with configuration object
     * @see docs/installation.md for mode details
     */
    const blokConfig = {
      /**
       * Enable/Disable the read only mode
       */
      readOnly: false,

      /**
       * Wrapper of Blok
       */
      holder: 'blok',

      /**
       * Common Inline Toolbar settings
       * - if true (or not specified), the order from 'tool' property will be used
       * - if an array of tool names, this order will be used
       */
      // inlineToolbar: ['link', 'bold', 'italic'],
      // inlineToolbar: true,

      /**
       * Tools list
       */
      tools: {
        /**
         * Each Tool is a Plugin. Pass them via 'class' option with necessary settings {@link docs/tools.md}
         * Tool options can be flat (no nested config: {}) - Blok extracts known keys automatically.
         * inlineToolbar defaults to true for block tools.
         */
        paragraph: {
          class: Paragraph,
          preserveBlank: true,
        },
        header: {
          class: Header,
          placeholder: 'Header',
        },
        list: List,
        table: Table,
        // Inline tools
        bold: Bold,
        italic: Italic,
        link: Link,
      },

      /**
       * This Tool will be used as default
       */
      // defaultBlock: 'paragraph',

      autofocus: true,

      /**
       * Initial Blok data
       */
      data: {
        blocks: [
          {
            id: "zcKCF1S7X8",
            type: "header",
            data: {
              text: "Blok - Block-Styled Editor",
              level: 1
            }
          },
          {
            id: "b6ji-DvaKb",
            type: "paragraph",
            data: {
              text: "Hey. Meet the new Blok. On this page you can see it in action — try to edit this text. Source code of the page contains the example of connection and configuration."
            }
          },
          {
            type: "header",
            id: "7ItVl5biRo",
            data: {
              text: "Header Levels",
              level: 2
            }
          },
          {
            id: "header-h1-example",
            type: "header",
            data: {
              text: "Heading 1 - Main Title",
              level: 1
            }
          },
          {
            id: "header-h2-example",
            type: "header",
            data: {
              text: "Heading 2 - Section Title",
              level: 2
            }
          },
          {
            id: "header-h3-example",
            type: "header",
            data: {
              text: "Heading 3 - Subsection Title",
              level: 3
            }
          },
          {
            id: "header-h4-example",
            type: "header",
            data: {
              text: "Heading 4 - Component Title",
              level: 4
            }
          },
          {
            id: "header-h5-example",
            type: "header",
            data: {
              text: "Heading 5 - Minor Title",
              level: 5
            }
          },
          {
            id: "header-h6-example",
            type: "header",
            data: {
              text: "Heading 6 - Smallest Title",
              level: 6
            }
          },
          {
            type: "header",
            id: "QZFox1m_ul",
            data: {
              text: "Inline Formatting",
              level: 2
            }
          },
          {
            id: "inline-example",
            type: "paragraph",
            data: {
              text: "You can make text <b>bold</b>, <i>italic</i>, or add <a href=\"https://github.com/JackUait/blok\">links</a>. Select any text to see the inline toolbar."
            }
          },
          {
            type: "header",
            id: "list-section-header",
            data: {
              text: "List Types",
              level: 2
            }
          },
          {
            type: "header",
            id: "unordered-list-header",
            data: {
              text: "Unordered List (Bulleted)",
              level: 3
            }
          },
          {
            id: "unordered-list-1",
            type: "list",
            data: {
              style: "unordered",
              text: "First item"
            }
          },
          {
            id: "unordered-list-2",
            type: "list",
            data: {
              style: "unordered",
              text: "Second item"
            }
          },
          {
            id: "unordered-list-3",
            type: "list",
            data: {
              style: "unordered",
              text: "Third item with <b>bold text</b>"
            }
          },
          {
            type: "header",
            id: "ordered-list-header",
            data: {
              text: "Ordered List (Numbered)",
              level: 3
            }
          },
          {
            id: "ordered-list-1",
            type: "list",
            data: {
              style: "ordered",
              text: "First step"
            }
          },
          {
            id: "ordered-list-2",
            type: "list",
            data: {
              style: "ordered",
              text: "Second step"
            }
          },
          {
            id: "ordered-list-3",
            type: "list",
            data: {
              style: "ordered",
              text: "Third step"
            }
          },
          {
            type: "header",
            id: "checklist-header",
            data: {
              text: "Checklist (Todo)",
              level: 3
            }
          },
          {
            id: "checklist-1",
            type: "list",
            data: {
              style: "checklist",
              text: "Learn Blok editor",
              checked: true
            }
          },
          {
            id: "checklist-2",
            type: "list",
            data: {
              style: "checklist",
              text: "Build something awesome"
            }
          },
          {
            id: "checklist-3",
            type: "list",
            data: {
              style: "checklist",
              text: "Share with the world"
            }
          },
          {
            type: "header",
            id: "nested-list-header",
            data: {
              text: "Nested Lists",
              level: 3
            }
          },
          {
            id: "nested-list-1",
            type: "list",
            data: {
              style: "unordered",
              text: "Main item"
            }
          },
          {
            id: "nested-list-2",
            type: "list",
            data: {
              style: "unordered",
              text: "Nested item (press Tab to indent)",
              depth: 1
            }
          },
          {
            id: "nested-list-3",
            type: "list",
            data: {
              style: "unordered",
              text: "Double nested item",
              depth: 2
            }
          },
          {
            id: "nested-list-4",
            type: "list",
            data: {
              style: "unordered",
              text: "Back to main level"
            }
          },
          {
            type: "header",
            id: "table-section-header",
            data: {
              text: "Tables",
              level: 2
            }
          },
          {
            id: "table-description",
            type: "paragraph",
            data: {
              text: "Tables support keyboard navigation (Tab to move between cells, Enter to move down) and can be pasted from other applications."
            }
          },
          {
            id: "table-example-1",
            type: "table",
            data: {
              withHeadings: true,
              content: [
                ["Feature", "Status", "Notes"],
                ["Grid rendering", "✅ Complete", "Supports any size"],
                ["Keyboard navigation", "✅ Complete", "Tab and Enter keys"],
                ["Paste support", "✅ Complete", "HTML tables supported"],
                ["Heading row", "✅ Complete", "Toggle in settings"]
              ]
            }
          },
          {
            type: "header",
            id: "simple-table-header",
            data: {
              text: "Simple Table (No Headers)",
              level: 3
            }
          },
          {
            id: "table-example-2",
            type: "table",
            data: {
              withHeadings: false,
              content: [
                ["Row 1, Cell 1", "Row 1, Cell 2"],
                ["Row 2, Cell 1", "Row 2, Cell 2"],
                ["Row 3, Cell 1", "Row 3, Cell 2"]
              ]
            }
          },
        ]
      },
      onChange: function(api, event) {
        console.log('something changed', event);
      },
    }
    /**
    * To initialize the Blok, create a new instance with configuration object
    * @see docs/installation.md for mode details
    */
    var blok = new Blok(blokConfig);

    /**
    * Toggle read-only button
    */
    const toggleReadOnlyButton = document.getElementById('toggleReadOnlyButton');
    const readOnlyIndicator = document.getElementById('readonly-state');

    /**
    * Toggle read-only example
    */
    toggleReadOnlyButton.addEventListener('click', async () => {
      const readOnlyState = await blok.readOnly.toggle();

      readOnlyIndicator.textContent = readOnlyState ? 'On' : 'Off';
    });

    /**
    * Button for enabling the 'Thin' mode
    */
    const enableThinModeButton = document.getElementById("enableThinModeButton");

    enableThinModeButton.addEventListener('click', () => {
      document.body.classList.toggle("thin-mode")

      blok.destroy();

      blok = new Blok(blokConfig);
    })

    window.blok = blok;

    /**
     * Tab switching
     */
    const tabs = document.querySelectorAll('[role="tab"]');
    const bottomBar = document.querySelector('#tab-editor .fixed');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const target = tab.dataset.tab;

        tabs.forEach(t => t.setAttribute('aria-selected', 'false'));
        tab.setAttribute('aria-selected', 'true');

        document.getElementById('tab-editor').classList.toggle('hidden', target !== 'editor');
        document.getElementById('tab-icons').classList.toggle('hidden', target !== 'icons');

        if (bottomBar) {
          bottomBar.classList.toggle('hidden', target !== 'editor');
        }
      });
    });

    /**
     * Icon gallery - group icons by category and render them
     */
    const iconGroups = {
      'UI & Navigation': ['IconCross', 'IconMenu', 'IconPlus', 'IconChevronLeft', 'IconChevronRight', 'IconSearch'],
      'Inline Formatting': ['IconBold', 'IconItalic', 'IconLink', 'IconReplace'],
      'Headings': ['IconHeading', 'IconH1', 'IconH2', 'IconH3', 'IconH4', 'IconH5', 'IconH6'],
      'Block Tools': ['IconText', 'IconListBulleted', 'IconListNumbered', 'IconListChecklist', 'IconTable'],
      'Table Actions': ['IconHeaderRow', 'IconHeaderColumn', 'IconInsertAbove', 'IconInsertBelow', 'IconInsertLeft', 'IconInsertRight', 'IconMoveUp', 'IconMoveDown', 'IconMoveLeft', 'IconMoveRight'],
      'Utility': ['IconTrash', 'IconWarning'],
    };

    const gallery = document.getElementById('icon-gallery');

    for (const [groupName, iconNames] of Object.entries(iconGroups)) {
      const group = document.createElement('div');
      group.className = 'icon-group';

      const title = document.createElement('div');
      title.className = 'icon-group-title';
      title.textContent = groupName;
      group.appendChild(title);

      const grid = document.createElement('div');
      grid.className = 'icon-grid';

      for (const name of iconNames) {
        const svg = Icons[name];
        if (!svg) continue;

        const cell = document.createElement('div');
        cell.className = 'icon-cell';

        const preview = document.createElement('div');
        preview.className = 'icon-preview';
        preview.innerHTML = svg;

        const label = document.createElement('div');
        label.className = 'icon-name';
        label.textContent = name;

        cell.appendChild(preview);
        cell.appendChild(label);
        grid.appendChild(cell);
      }

      group.appendChild(grid);
      gallery.appendChild(group);
    }
  </script>
</body>
</html>
