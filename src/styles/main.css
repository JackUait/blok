/* Tailwind CSS - must be first */
@import 'tailwindcss';

@custom-variant mobile (@media (max-width: 650px));
@custom-variant not-mobile (@media (min-width: 651px));
@custom-variant can-hover (@media (hover: hover));

@config '../../tailwind.config.js';

/*
  The default border color has changed to `currentcolor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentcolor);
  }
}

/**
 * Component classes for the Styles API.
 * These single-class names can be safely used with classList.add() by external plugins.
 * Each class bundles multiple Tailwind utilities using @apply.
 */
@utility blok-block {
  /* Base Blok styles - applied to block tool wrappers */
  @apply py-[3px] px-[2px] [&::-webkit-input-placeholder]:leading-normal!;
}
@utility blok-inline-tool-button {
  /* Inline Tools styles */
  @apply flex justify-center items-center border-0 rounded-sm h-full p-0 w-7 bg-transparent cursor-pointer leading-normal text-black;
}
@utility blok-inline-tool-button--active {
  @apply bg-icon-active-bg text-icon-active-text;
}
@utility blok-input {
  /* Input element styles */
  @apply w-full rounded-[3px] border border-line-gray px-3 py-2.5 outline-hidden shadow-input data-blok-placeholder:before:static! data-blok-placeholder:before:inline-block data-blok-placeholder:before:w-0 data-blok-placeholder:before:whitespace-nowrap data-blok-placeholder:before:pointer-events-none;
}
@utility blok-loader {
  /* Loader styles with spinning animation */
  @apply relative border border-line-gray before:absolute before:left-1/2 before:top-1/2 before:w-[18px] before:h-[18px] before:rounded-full before:content-[''] before:-ml-[11px] before:-mt-[11px] before:border-2 before:border-line-gray before:border-l-active-icon before:animate-rotation;
}
@utility blok-button {
  /* Button styles */
  @apply p-[13px] rounded-[3px] border border-line-gray text-[14.9px] bg-white text-center cursor-pointer text-gray-text shadow-button-base hover:bg-[#fbfcfe] hover:shadow-button-base-hover [&_svg]:h-5 [&_svg]:mr-[0.2em] [&_svg]:-mt-0.5;
}
@utility blok-settings-button {
  /* Settings button styles */
  @apply inline-flex items-center justify-center rounded-[3px] cursor-pointer border-0 outline-hidden bg-transparent align-bottom text-inherit m-0 min-w-toolbox-btn min-h-toolbox-btn [&_svg]:w-auto [&_svg]:h-auto mobile:w-toolbox-btn-mobile mobile:h-toolbox-btn-mobile mobile:rounded-lg mobile:[&_svg]:w-icon-mobile mobile:[&_svg]:h-icon-mobile can-hover:hover:bg-bg-light;
}
@utility blok-settings-button--active {
  @apply text-active-icon;
}
@utility blok-settings-button--focused {
  @apply shadow-button-focused bg-item-focus-bg;
}
@utility blok-settings-button--focused-animated {
  @apply animate-button-clicked;
}

/**
 * Navigation mode styles
 * Applied when user enters block navigation mode via Escape key
 */
[data-blok-navigation-focused="true"] {
  @apply bg-item-focus-bg rounded-md w-content-width max-w-full mx-auto;
}

/**
 * Delete button hover styles
 * Makes the delete button text and icon appear red on hover
 */
@media (hover: hover) {
  [data-blok-item-name="delete"]:hover {
    @apply text-item-confirm-bg transition-colors;
  }
}

/**
 * Drop indicator styles for drag and drop
 * Shows a visual line at the top or bottom of a block during drag
 * The --drop-indicator-depth CSS variable controls indentation based on target nesting level
 */
[data-drop-indicator] {
  @apply relative;
}

[data-drop-indicator]::before {
  @apply content-[''] absolute w-full max-w-content h-1.5 rounded-xs bg-[#d4e3fc] pointer-events-none z-10;
  left: 50%;
  margin-left: calc(var(--drop-indicator-depth, 0) * 12px);
  max-width: calc(650px - var(--drop-indicator-depth, 0) * 24px);
}

[data-drop-indicator="bottom"]::before {
  @apply bottom-0;
  transform: translateX(-50%) translateY(50%);
}

[data-drop-indicator="top"]::before {
  @apply top-0;
  transform: translateX(-50%) translateY(-50%);
}

/**
 * Multi-block drag visual feedback
 * Makes selected blocks semi-transparent during multi-block drag operation
 */
[data-blok-dragging-multi="true"] [data-blok-selected="true"] {
  @apply opacity-40 transition-opacity duration-200;
}

/**
 * List item selection styles
 * Applies selection background to the list item itself (not the content wrapper)
 * so that margin-left indentation is respected
 */
[data-blok-selected="true"] [data-blok-element-content]:has([data-list-style]) {
  @apply bg-transparent;
}

[data-blok-selected="true"] [data-list-style] [role="listitem"] {
  @apply bg-selection rounded-[4px];
}

[data-blok-selected="true"] [data-list-style] [role="listitem"] [contenteditable] {
  @apply select-none;
}

/**
 * Table cell block wrapper overrides
 * Strip all nested spacing so only the cell's own padding (py-1 px-2) provides spacing.
 * Targets: block wrapper (py/my), .blok-block (py/px), and tool elements (mt/mb).
 */
[data-blok-table-cell-blocks] > [data-blok-element] {
  @apply py-0 my-0;
}

[data-blok-table-cell-blocks] .blok-block {
  @apply p-0 m-0 min-h-[1.6em];
}

/**
 * Table heading styles
 * Applied to first row (heading row) and first column (heading column) cells
 */
[data-blok-table-heading] [data-blok-table-cell],
[data-blok-table-heading-col] {
  @apply font-semibold bg-gray-50;
}

/**
 * Table scroll haze overlays
 * Gradient indicators that show horizontal scroll availability
 */
[data-blok-table-haze][data-blok-table-haze-visible] {
  @apply opacity-100;
}
